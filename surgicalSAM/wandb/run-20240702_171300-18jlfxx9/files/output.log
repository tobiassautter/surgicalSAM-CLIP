======> Start Training and Validation
3778
Updated learning rate: [0.004875, 0.004875, 0.004875]
Validation - Epoch: 0/199; IoU_Results: {'challengIoU': 22.569, 'IoU': 22.569, 'mcIoU': 12.706, 'mIoU': 24.637, 'cIoU_per_class': [27.773, 8.314, 10.014, 24.383, 2.93, 2.88, 12.651]}
Timestamp: 2024-07-02 17:15:17.252285 -----------------------------------------------
Best Challenge IoU: 22.5690 at Epoch 0
3778
Validation - Epoch: 1/199; IoU_Results: {'challengIoU': 18.583, 'IoU': 18.583, 'mcIoU': 10.34, 'mIoU': 21.481, 'cIoU_per_class': [19.969, 10.117, 7.108, 24.065, 0.918, 0.457, 9.746]}
Timestamp: 2024-07-02 17:17:53.946355 -----------------------------------------------
3778
Updated learning rate: [0.0047531249999999995, 0.0047531249999999995, 0.0047531249999999995]
Validation - Epoch: 2/199; IoU_Results: {'challengIoU': 20.848, 'IoU': 20.848, 'mcIoU': 10.074, 'mIoU': 21.54, 'cIoU_per_class': [24.646, 6.637, 4.514, 28.421, 0.924, 0.702, 4.677]}
Timestamp: 2024-07-02 17:20:25.276123 -----------------------------------------------
3778
Validation - Epoch: 3/199; IoU_Results: {'challengIoU': 22.985, 'IoU': 22.985, 'mcIoU': 14.358, 'mIoU': 26.88, 'cIoU_per_class': [16.412, 11.613, 20.433, 35.178, 7.573, 1.046, 8.249]}
Timestamp: 2024-07-02 17:23:00.197927 -----------------------------------------------
Best Challenge IoU: 22.9850 at Epoch 3
3778
Updated learning rate: [0.004634296874999999, 0.004634296874999999, 0.004634296874999999]
Validation - Epoch: 4/199; IoU_Results: {'challengIoU': 35.91, 'IoU': 35.91, 'mcIoU': 22.67, 'mIoU': 37.866, 'cIoU_per_class': [35.566, 15.223, 32.485, 46.436, 19.924, 1.01, 8.048]}
Timestamp: 2024-07-02 17:25:30.327597 -----------------------------------------------
Best Challenge IoU: 35.9100 at Epoch 4
3778
Validation - Epoch: 5/199; IoU_Results: {'challengIoU': 30.597, 'IoU': 30.597, 'mcIoU': 19.973, 'mIoU': 33.099, 'cIoU_per_class': [25.42, 14.298, 31.968, 44.215, 16.192, 1.122, 6.597]}
Timestamp: 2024-07-02 17:28:02.514750 -----------------------------------------------
3778
Updated learning rate: [0.004518439453124999, 0.004518439453124999, 0.004518439453124999]
Validation - Epoch: 6/199; IoU_Results: {'challengIoU': 26.577, 'IoU': 26.577, 'mcIoU': 16.598, 'mIoU': 28.81, 'cIoU_per_class': [21.331, 12.728, 21.781, 41.383, 10.26, 0.105, 8.599]}
Timestamp: 2024-07-02 17:30:38.709901 -----------------------------------------------
3778
Traceback (most recent call last):
  File "/graphics/scratch2/students/sautterto/surgicalMDSAM/surgicalSAM/train_medSAM_l.py", line 250, in <module>
    preds, _ = model_forward_function(
  File "/graphics/scratch2/students/sautterto/surgicalMDSAM/surgicalSAM/model_forward.py", line 24, in model_forward_function
    low_res_masks_per_image, mask_quality_per_image = sam_decoder(
  File "/graphics/scratch2/students/sautterto/surgicalMDSAM/ENV/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/graphics/scratch2/students/sautterto/surgicalMDSAM/surgicalSAM/../segment_anything/modeling/mask_decoder.py", line 94, in forward
    masks, iou_pred = self.predict_masks(
  File "/graphics/scratch2/students/sautterto/surgicalMDSAM/surgicalSAM/../segment_anything/modeling/mask_decoder.py", line 126, in predict_masks
    src = torch.repeat_interleave(image_embeddings, tokens.shape[0], dim=0)
KeyboardInterrupt